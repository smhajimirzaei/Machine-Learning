{"title":"CV for Tie-Ballast","markdown":{"yaml":{"title":"CV for Tie-Ballast","author":"Morteza Mirzaei","date":"2023-12-09","categories":["code","analysis"],"image":"image.jpg"},"headingText":"Reduce size","containsRefs":false,"markdown":"\n\nThis study develops an effective system for in-motion and autonomous identification of crossties and ballast, toward implementing non-contact sensors that can evaluate the condition of railroad structures. An array of sensors that include distance LIDAR sensors, magnetic sensors, and cameras are employed to test a prototype system in motion, onboard a remotely controlled track cart that can travel at speeds of up to 10 mph. The tests are performed on revenue-service tracks and the measurements are used to develop autonomous post-processing approaches that can be readily adopted by the railroads. Two distinct techniques for the LIDAR sensors are explored. Next, a machine learning model is developed to achieve the task with potentially more accuracy. To this end, three machine learning models, using three types of inputs, are developed to identify the optimal model. The DecisionTree algorithm coupled with the standard deviation of the difference between two distance sensors proved to be the most effective.\n\n``` python\nfrom google.colab import drive\ndrive.mount('/content/drive')\n```\n\n```         \nMounted at /content/drive\n```\n\n``` python\n!pip install moviepy\n!pip3 install imageio==2.4.1\n!pip install --upgrade imageio-ffmpeg\n```\n\nImport the required libraries\n\n``` python\nimport cv2\nimport os\nimport numpy as np\nimport pandas as pd\nfrom google.colab.patches import cv2_imshow\nfrom numpy import genfromtxt\nfrom PIL import Image\nimport os\nimport moviepy.editor as mp\nfrom sklearn.utils import shuffle\nfrom sklearn.model_selection import train_test_split\n```\n\n\nDefine the video path and a path to save the reduced-size frames\n\n``` python\nvideo_path = '/content/drive/MyDrive/Track Buckling Project/230306 - Third Huckleberry Trail Test/GoPro/GX011334.MP4'\nsave_path = '/content/drive/MyDrive/Vision/Huckelberry/March_1'\n\ncap = cv2.VideoCapture(video_path)\n```\n\nHere is a frame of this video\n\n``` python\ncap.set(cv2.CAP_PROP_POS_MSEC,500000)\nhasFrames,image0 = cap.read()\n\nprint(\"The size of the frame : \", image0.shape)\ncv2_imshow(image0)\n```\n\n```         \nThe size of the frame :  (2988, 5312, 3)\n```\n\n![](images/20.png)\n\n``` python\nfps = cap.get(cv2.CAP_PROP_FPS)\nprint(\"Frame rate of the video is : \", fps)\n```\n\n```         \nFrame rate of the video is : 29.97002997002997\n```\n\n``` python\nclip_duration = cap.get(cv2.CAP_PROP_FRAME_COUNT) / cap.get(cv2.CAP_PROP_FPS)\nprint(\"Clip duration : {} (s)\".format(clip_duration))\n```\n\n```         \nClip duration : 766.6325333333333 (s)\n```\n\nSince processing 30 frames per second is too demanding, we need to resample the video to reduce computation time while still maintaining satisfactory spatial resolution. We opted for 10 fps\n\n``` python\nsp = 1 / 10\n```\n\nEach frame captures a wide range of views. To enhance precision, only a specific section of the image will be analyzed, while the rest will be ignored.\n\n``` python\ncv2_imshow(image0[:, int(image0.shape[1]/2-100):int(image0.shape[1]/2+100)])\n```\n\n![](images/21.png)\n\nIn this block all the frames will be shrinked by the factor of 1/10\n\n``` python\nclip = mp.VideoFileClip(video_path)\n\nmy_width = image0.shape[0]//10\nmy_height = image0.shape[1]//10\n\nclip_resized = clip.resize(newsize=(my_width,my_height))\nclip_resized.write_videofile(save_path + '/resized_video/1334_resized.MP4')\n```\n\n# Framing\n\n``` python\nvideo_path = save_path + '/resized_video/1334_resized.MP4' # reduced-size video path\n\ncap = cv2.VideoCapture(video_path)\ncap.set(cv2.CAP_PROP_POS_MSEC,500000)\nhasFrames,image0 = cap.read()\n\ncv2_imshow(image0[:, int(image0.shape[1]/2-10):int(image0.shape[1]/2+10)])\n```\n\n# Save the frames\n\nIn this block all the frames will be saved as seperate images for easier future use. The name of each frame will be: Index\\_\"frame number\".jpg\n\n``` python\ntime = 0\nimg = []\nt = []\n\nc = 0\npath = '/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Index_'\n\nwhile (time+500)<clip_duration:\n  cap.set(cv2.CAP_PROP_POS_MSEC,(time+500)*1000)\n  hasFrames,image = cap.read()\n  if hasFrames:\n    image = image[:, int(image.shape[1]/2-10):int(image.shape[1]/2+10)]\n    cv2.imwrite(path + str(c) + '.jpg', image)\n    img.append(image)\n    t.append(time)\n    c = c + 1\n  time += fps\n```\n\n``` python\nd = {'processed_images': img, 'time': t}\ndf = pd.DataFrame(data=d)\n\ndf.to_csv('/content/drive/MyDrive/Track Buckling Project/230306 - Third Huckleberry Trail Test/GoPro/1334_resized.csv')\n```\n\n# Load the data\n\n``` python\ndf_new = pd.read_csv('/content/drive/MyDrive/Track Buckling Project/230306 - Third Huckleberry Trail Test/GoPro/1334_resized.csv')\n```\n\n``` python\ndirpath = '/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/'\n```\n\nReload the images and their respective index\n\n``` python\nshots = []\nidx = []\n\nfor i in range(0, df_new['time'].shape[0]):\n  if os.path.exists(dirpath + 'Index_' + str(i) + '.jpg'):\n    shots.append(cv2.imread(dirpath + 'Index_' + str(i) + '.jpg'))\n    idx.append('Index_' + str(i))\n  else:\n    break\n\n\ndf_new['image_index'] = idx\ndf_new['processed_images'] = shots\n```\n\n# Training\n\n## Labeling\n\nBefore training the model, we need to manually label the images. For this purpose, a section of the dataset is chosen and labeled. The indices for all the ties in that specific section are saved in the following dataframe.\n\n``` python\ntie_index = pd.read_excel('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training/tie_index.xlsx')\n```\n\n``` python\nlabel = np.zeros(df_new['image_index'].shape[0])\n\nfor i in tie_index['tie_index']:\n  label[i] = 1\n\ndf_new['labels'] = label\ndf_train = df_new[(df_new['Unnamed: 0']>=47) & (df_new['Unnamed: 0']<=193)]\n```\n\nDefining the features\n\n``` python\nfeatures = []\n\nfor i in range(0, len(df_train['processed_images'])):\n  features.append(np.array(cv2.resize(df_train.iloc[i]['processed_images'], (100, 500))))\n\n\nfeatures = np.array(features)\n```\n\nDefining the labels\n\n``` python\nlabels = df_train['labels']\n```\n\nNormalizing the features\n\n``` python\nfeatures = features.astype('float32') / 255.0\n```\n\n## Train/Test Split\n\n``` python\ntrain_x, test_x, train_y, test_y = train_test_split(features, labels, test_size=0.2, stratify=labels)\n```\n\nAccording to the block below we have 117 data points in training set and 30 data points in test set\n\n``` python\nprint(train_x.shape)\nprint(train_y.shape)\nprint(test_x.shape)\nprint(test_y.shape)\n```\n\n```         \n(117, 500, 100, 3)\n(117,)\n(30, 500, 100, 3)\n(30,)\n```\n\n``` python\nfrom keras.applications.inception_v3 import InceptionV3\nfrom keras.preprocessing import image\nfrom keras.models import Model, Sequential\nfrom keras.layers import Dense, GlobalAveragePooling2D, Dropout, Flatten, Dense\n```\n\n## Importing Inception V3\n\n``` python\nbase_model = InceptionV3(weights='imagenet', include_top=False,input_shape=(train_x.shape[1],train_x.shape[2],train_x.shape[3]))\nfor layer in base_model.layers:\n    layer.trainable = False\n\nx = base_model.output\nx = GlobalAveragePooling2D()(x)\nx = Dense(1024, activation='relu')(x)\npredictions = Dense(1, activation='sigmoid')(x)\n\nImported_model = Model(inputs=base_model.input, outputs=predictions)\n```\n\n``` python\nImported_model.summary()\n```\n\n```         \nModel: \"model_1\"\n__________________________________________________________________________________________________\n Layer (type)                Output Shape                 Param #   Connected to                  \n==================================================================================================\n input_2 (InputLayer)        [(None, 500, 100, 3)]        0         []                            \n                                                                                                  \n conv2d_94 (Conv2D)          (None, 249, 49, 32)          864       ['input_2[0][0]']             \n                                                                                                  \n batch_normalization_94 (Ba  (None, 249, 49, 32)          96        ['conv2d_94[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_94 (Activation)  (None, 249, 49, 32)          0         ['batch_normalization_94[0][0]\n                                                                    ']                            \n                                                                                                  \n conv2d_95 (Conv2D)          (None, 247, 47, 32)          9216      ['activation_94[0][0]']       \n                                                                                                  \n batch_normalization_95 (Ba  (None, 247, 47, 32)          96        ['conv2d_95[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_95 (Activation)  (None, 247, 47, 32)          0         ['batch_normalization_95[0][0]\n                                                                    ']                            \n                                                                                                  \n conv2d_96 (Conv2D)          (None, 247, 47, 64)          18432     ['activation_95[0][0]']       \n                                                                                                  \n batch_normalization_96 (Ba  (None, 247, 47, 64)          192       ['conv2d_96[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_96 (Activation)  (None, 247, 47, 64)          0         ['batch_normalization_96[0][0]\n                                                                    ']                            \n                                                                                                  \n max_pooling2d_4 (MaxPoolin  (None, 123, 23, 64)          0         ['activation_96[0][0]']       \n g2D)                                                                                             \n                                                                                                  \n conv2d_97 (Conv2D)          (None, 123, 23, 80)          5120      ['max_pooling2d_4[0][0]']     \n                                                                                                  \n batch_normalization_97 (Ba  (None, 123, 23, 80)          240       ['conv2d_97[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_97 (Activation)  (None, 123, 23, 80)          0         ['batch_normalization_97[0][0]\n                                                                    ']                            \n                                                                                                  \n conv2d_98 (Conv2D)          (None, 121, 21, 192)         138240    ['activation_97[0][0]']       \n                                                                                                  \n batch_normalization_98 (Ba  (None, 121, 21, 192)         576       ['conv2d_98[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_98 (Activation)  (None, 121, 21, 192)         0         ['batch_normalization_98[0][0]\n                                                                    ']                            \n                                                                                                  \n max_pooling2d_5 (MaxPoolin  (None, 60, 10, 192)          0         ['activation_98[0][0]']       \n g2D)                                                                                             \n                                                                                                  \n conv2d_102 (Conv2D)         (None, 60, 10, 64)           12288     ['max_pooling2d_5[0][0]']     \n                                                                                                  \n batch_normalization_102 (B  (None, 60, 10, 64)           192       ['conv2d_102[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_102 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_102[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_100 (Conv2D)         (None, 60, 10, 48)           9216      ['max_pooling2d_5[0][0]']     \n                                                                                                  \n conv2d_103 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_102[0][0]']      \n                                                                                                  \n batch_normalization_100 (B  (None, 60, 10, 48)           144       ['conv2d_100[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_103 (B  (None, 60, 10, 96)           288       ['conv2d_103[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_100 (Activation  (None, 60, 10, 48)           0         ['batch_normalization_100[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_103 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_103[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_9 (Avera  (None, 60, 10, 192)          0         ['max_pooling2d_5[0][0]']     \n gePooling2D)                                                                                     \n                                                                                                  \n conv2d_99 (Conv2D)          (None, 60, 10, 64)           12288     ['max_pooling2d_5[0][0]']     \n                                                                                                  \n conv2d_101 (Conv2D)         (None, 60, 10, 64)           76800     ['activation_100[0][0]']      \n                                                                                                  \n conv2d_104 (Conv2D)         (None, 60, 10, 96)           82944     ['activation_103[0][0]']      \n                                                                                                  \n conv2d_105 (Conv2D)         (None, 60, 10, 32)           6144      ['average_pooling2d_9[0][0]'] \n                                                                                                  \n batch_normalization_99 (Ba  (None, 60, 10, 64)           192       ['conv2d_99[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n batch_normalization_101 (B  (None, 60, 10, 64)           192       ['conv2d_101[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_104 (B  (None, 60, 10, 96)           288       ['conv2d_104[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_105 (B  (None, 60, 10, 32)           96        ['conv2d_105[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_99 (Activation)  (None, 60, 10, 64)           0         ['batch_normalization_99[0][0]\n                                                                    ']                            \n                                                                                                  \n activation_101 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_101[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_104 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_104[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_105 (Activation  (None, 60, 10, 32)           0         ['batch_normalization_105[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed0 (Concatenate)        (None, 60, 10, 256)          0         ['activation_99[0][0]',       \n                                                                     'activation_101[0][0]',      \n                                                                     'activation_104[0][0]',      \n                                                                     'activation_105[0][0]']      \n                                                                                                  \n conv2d_109 (Conv2D)         (None, 60, 10, 64)           16384     ['mixed0[0][0]']              \n                                                                                                  \n batch_normalization_109 (B  (None, 60, 10, 64)           192       ['conv2d_109[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_109 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_109[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_107 (Conv2D)         (None, 60, 10, 48)           12288     ['mixed0[0][0]']              \n                                                                                                  \n conv2d_110 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_109[0][0]']      \n                                                                                                  \n batch_normalization_107 (B  (None, 60, 10, 48)           144       ['conv2d_107[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_110 (B  (None, 60, 10, 96)           288       ['conv2d_110[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_107 (Activation  (None, 60, 10, 48)           0         ['batch_normalization_107[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_110 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_110[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_10 (Aver  (None, 60, 10, 256)          0         ['mixed0[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_106 (Conv2D)         (None, 60, 10, 64)           16384     ['mixed0[0][0]']              \n                                                                                                  \n conv2d_108 (Conv2D)         (None, 60, 10, 64)           76800     ['activation_107[0][0]']      \n                                                                                                  \n conv2d_111 (Conv2D)         (None, 60, 10, 96)           82944     ['activation_110[0][0]']      \n                                                                                                  \n conv2d_112 (Conv2D)         (None, 60, 10, 64)           16384     ['average_pooling2d_10[0][0]']\n                                                                                                  \n batch_normalization_106 (B  (None, 60, 10, 64)           192       ['conv2d_106[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_108 (B  (None, 60, 10, 64)           192       ['conv2d_108[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_111 (B  (None, 60, 10, 96)           288       ['conv2d_111[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_112 (B  (None, 60, 10, 64)           192       ['conv2d_112[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_106 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_106[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_108 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_108[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_111 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_111[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_112 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_112[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed1 (Concatenate)        (None, 60, 10, 288)          0         ['activation_106[0][0]',      \n                                                                     'activation_108[0][0]',      \n                                                                     'activation_111[0][0]',      \n                                                                     'activation_112[0][0]']      \n                                                                                                  \n conv2d_116 (Conv2D)         (None, 60, 10, 64)           18432     ['mixed1[0][0]']              \n                                                                                                  \n batch_normalization_116 (B  (None, 60, 10, 64)           192       ['conv2d_116[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_116 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_116[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_114 (Conv2D)         (None, 60, 10, 48)           13824     ['mixed1[0][0]']              \n                                                                                                  \n conv2d_117 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_116[0][0]']      \n                                                                                                  \n batch_normalization_114 (B  (None, 60, 10, 48)           144       ['conv2d_114[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_117 (B  (None, 60, 10, 96)           288       ['conv2d_117[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_114 (Activation  (None, 60, 10, 48)           0         ['batch_normalization_114[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_117 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_117[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_11 (Aver  (None, 60, 10, 288)          0         ['mixed1[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_113 (Conv2D)         (None, 60, 10, 64)           18432     ['mixed1[0][0]']              \n                                                                                                  \n conv2d_115 (Conv2D)         (None, 60, 10, 64)           76800     ['activation_114[0][0]']      \n                                                                                                  \n conv2d_118 (Conv2D)         (None, 60, 10, 96)           82944     ['activation_117[0][0]']      \n                                                                                                  \n conv2d_119 (Conv2D)         (None, 60, 10, 64)           18432     ['average_pooling2d_11[0][0]']\n                                                                                                  \n batch_normalization_113 (B  (None, 60, 10, 64)           192       ['conv2d_113[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_115 (B  (None, 60, 10, 64)           192       ['conv2d_115[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_118 (B  (None, 60, 10, 96)           288       ['conv2d_118[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_119 (B  (None, 60, 10, 64)           192       ['conv2d_119[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_113 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_113[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_115 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_115[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_118 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_118[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_119 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_119[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed2 (Concatenate)        (None, 60, 10, 288)          0         ['activation_113[0][0]',      \n                                                                     'activation_115[0][0]',      \n                                                                     'activation_118[0][0]',      \n                                                                     'activation_119[0][0]']      \n                                                                                                  \n conv2d_121 (Conv2D)         (None, 60, 10, 64)           18432     ['mixed2[0][0]']              \n                                                                                                  \n batch_normalization_121 (B  (None, 60, 10, 64)           192       ['conv2d_121[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_121 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_121[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_122 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_121[0][0]']      \n                                                                                                  \n batch_normalization_122 (B  (None, 60, 10, 96)           288       ['conv2d_122[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_122 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_122[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_120 (Conv2D)         (None, 29, 4, 384)           995328    ['mixed2[0][0]']              \n                                                                                                  \n conv2d_123 (Conv2D)         (None, 29, 4, 96)            82944     ['activation_122[0][0]']      \n                                                                                                  \n batch_normalization_120 (B  (None, 29, 4, 384)           1152      ['conv2d_120[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_123 (B  (None, 29, 4, 96)            288       ['conv2d_123[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_120 (Activation  (None, 29, 4, 384)           0         ['batch_normalization_120[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_123 (Activation  (None, 29, 4, 96)            0         ['batch_normalization_123[0][0\n )                                                                  ]']                           \n                                                                                                  \n max_pooling2d_6 (MaxPoolin  (None, 29, 4, 288)           0         ['mixed2[0][0]']              \n g2D)                                                                                             \n                                                                                                  \n mixed3 (Concatenate)        (None, 29, 4, 768)           0         ['activation_120[0][0]',      \n                                                                     'activation_123[0][0]',      \n                                                                     'max_pooling2d_6[0][0]']     \n                                                                                                  \n conv2d_128 (Conv2D)         (None, 29, 4, 128)           98304     ['mixed3[0][0]']              \n                                                                                                  \n batch_normalization_128 (B  (None, 29, 4, 128)           384       ['conv2d_128[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_128 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_128[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_129 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_128[0][0]']      \n                                                                                                  \n batch_normalization_129 (B  (None, 29, 4, 128)           384       ['conv2d_129[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_129 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_129[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_125 (Conv2D)         (None, 29, 4, 128)           98304     ['mixed3[0][0]']              \n                                                                                                  \n conv2d_130 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_129[0][0]']      \n                                                                                                  \n batch_normalization_125 (B  (None, 29, 4, 128)           384       ['conv2d_125[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_130 (B  (None, 29, 4, 128)           384       ['conv2d_130[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_125 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_125[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_130 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_130[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_126 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_125[0][0]']      \n                                                                                                  \n conv2d_131 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_130[0][0]']      \n                                                                                                  \n batch_normalization_126 (B  (None, 29, 4, 128)           384       ['conv2d_126[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_131 (B  (None, 29, 4, 128)           384       ['conv2d_131[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_126 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_126[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_131 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_131[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_12 (Aver  (None, 29, 4, 768)           0         ['mixed3[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_124 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed3[0][0]']              \n                                                                                                  \n conv2d_127 (Conv2D)         (None, 29, 4, 192)           172032    ['activation_126[0][0]']      \n                                                                                                  \n conv2d_132 (Conv2D)         (None, 29, 4, 192)           172032    ['activation_131[0][0]']      \n                                                                                                  \n conv2d_133 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_12[0][0]']\n                                                                                                  \n batch_normalization_124 (B  (None, 29, 4, 192)           576       ['conv2d_124[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_127 (B  (None, 29, 4, 192)           576       ['conv2d_127[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_132 (B  (None, 29, 4, 192)           576       ['conv2d_132[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_133 (B  (None, 29, 4, 192)           576       ['conv2d_133[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_124 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_124[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_127 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_127[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_132 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_132[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_133 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_133[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed4 (Concatenate)        (None, 29, 4, 768)           0         ['activation_124[0][0]',      \n                                                                     'activation_127[0][0]',      \n                                                                     'activation_132[0][0]',      \n                                                                     'activation_133[0][0]']      \n                                                                                                  \n conv2d_138 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed4[0][0]']              \n                                                                                                  \n batch_normalization_138 (B  (None, 29, 4, 160)           480       ['conv2d_138[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_138 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_138[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_139 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_138[0][0]']      \n                                                                                                  \n batch_normalization_139 (B  (None, 29, 4, 160)           480       ['conv2d_139[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_139 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_139[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_135 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed4[0][0]']              \n                                                                                                  \n conv2d_140 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_139[0][0]']      \n                                                                                                  \n batch_normalization_135 (B  (None, 29, 4, 160)           480       ['conv2d_135[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_140 (B  (None, 29, 4, 160)           480       ['conv2d_140[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_135 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_135[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_140 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_140[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_136 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_135[0][0]']      \n                                                                                                  \n conv2d_141 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_140[0][0]']      \n                                                                                                  \n batch_normalization_136 (B  (None, 29, 4, 160)           480       ['conv2d_136[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_141 (B  (None, 29, 4, 160)           480       ['conv2d_141[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_136 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_136[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_141 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_141[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_13 (Aver  (None, 29, 4, 768)           0         ['mixed4[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_134 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed4[0][0]']              \n                                                                                                  \n conv2d_137 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_136[0][0]']      \n                                                                                                  \n conv2d_142 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_141[0][0]']      \n                                                                                                  \n conv2d_143 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_13[0][0]']\n                                                                                                  \n batch_normalization_134 (B  (None, 29, 4, 192)           576       ['conv2d_134[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_137 (B  (None, 29, 4, 192)           576       ['conv2d_137[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_142 (B  (None, 29, 4, 192)           576       ['conv2d_142[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_143 (B  (None, 29, 4, 192)           576       ['conv2d_143[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_134 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_134[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_137 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_137[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_142 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_142[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_143 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_143[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed5 (Concatenate)        (None, 29, 4, 768)           0         ['activation_134[0][0]',      \n                                                                     'activation_137[0][0]',      \n                                                                     'activation_142[0][0]',      \n                                                                     'activation_143[0][0]']      \n                                                                                                  \n conv2d_148 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed5[0][0]']              \n                                                                                                  \n batch_normalization_148 (B  (None, 29, 4, 160)           480       ['conv2d_148[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_148 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_148[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_149 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_148[0][0]']      \n                                                                                                  \n batch_normalization_149 (B  (None, 29, 4, 160)           480       ['conv2d_149[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_149 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_149[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_145 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed5[0][0]']              \n                                                                                                  \n conv2d_150 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_149[0][0]']      \n                                                                                                  \n batch_normalization_145 (B  (None, 29, 4, 160)           480       ['conv2d_145[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_150 (B  (None, 29, 4, 160)           480       ['conv2d_150[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_145 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_145[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_150 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_150[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_146 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_145[0][0]']      \n                                                                                                  \n conv2d_151 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_150[0][0]']      \n                                                                                                  \n batch_normalization_146 (B  (None, 29, 4, 160)           480       ['conv2d_146[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_151 (B  (None, 29, 4, 160)           480       ['conv2d_151[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_146 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_146[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_151 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_151[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_14 (Aver  (None, 29, 4, 768)           0         ['mixed5[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_144 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed5[0][0]']              \n                                                                                                  \n conv2d_147 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_146[0][0]']      \n                                                                                                  \n conv2d_152 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_151[0][0]']      \n                                                                                                  \n conv2d_153 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_14[0][0]']\n                                                                                                  \n batch_normalization_144 (B  (None, 29, 4, 192)           576       ['conv2d_144[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_147 (B  (None, 29, 4, 192)           576       ['conv2d_147[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_152 (B  (None, 29, 4, 192)           576       ['conv2d_152[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_153 (B  (None, 29, 4, 192)           576       ['conv2d_153[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_144 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_144[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_147 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_147[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_152 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_152[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_153 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_153[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed6 (Concatenate)        (None, 29, 4, 768)           0         ['activation_144[0][0]',      \n                                                                     'activation_147[0][0]',      \n                                                                     'activation_152[0][0]',      \n                                                                     'activation_153[0][0]']      \n                                                                                                  \n conv2d_158 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed6[0][0]']              \n                                                                                                  \n batch_normalization_158 (B  (None, 29, 4, 192)           576       ['conv2d_158[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_158 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_158[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_159 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_158[0][0]']      \n                                                                                                  \n batch_normalization_159 (B  (None, 29, 4, 192)           576       ['conv2d_159[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_159 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_159[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_155 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed6[0][0]']              \n                                                                                                  \n conv2d_160 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_159[0][0]']      \n                                                                                                  \n batch_normalization_155 (B  (None, 29, 4, 192)           576       ['conv2d_155[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_160 (B  (None, 29, 4, 192)           576       ['conv2d_160[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_155 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_155[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_160 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_160[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_156 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_155[0][0]']      \n                                                                                                  \n conv2d_161 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_160[0][0]']      \n                                                                                                  \n batch_normalization_156 (B  (None, 29, 4, 192)           576       ['conv2d_156[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_161 (B  (None, 29, 4, 192)           576       ['conv2d_161[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_156 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_156[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_161 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_161[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_15 (Aver  (None, 29, 4, 768)           0         ['mixed6[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_154 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed6[0][0]']              \n                                                                                                  \n conv2d_157 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_156[0][0]']      \n                                                                                                  \n conv2d_162 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_161[0][0]']      \n                                                                                                  \n conv2d_163 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_15[0][0]']\n                                                                                                  \n batch_normalization_154 (B  (None, 29, 4, 192)           576       ['conv2d_154[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_157 (B  (None, 29, 4, 192)           576       ['conv2d_157[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_162 (B  (None, 29, 4, 192)           576       ['conv2d_162[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_163 (B  (None, 29, 4, 192)           576       ['conv2d_163[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_154 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_154[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_157 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_157[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_162 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_162[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_163 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_163[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed7 (Concatenate)        (None, 29, 4, 768)           0         ['activation_154[0][0]',      \n                                                                     'activation_157[0][0]',      \n                                                                     'activation_162[0][0]',      \n                                                                     'activation_163[0][0]']      \n                                                                                                  \n conv2d_166 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed7[0][0]']              \n                                                                                                  \n batch_normalization_166 (B  (None, 29, 4, 192)           576       ['conv2d_166[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_166 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_166[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_167 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_166[0][0]']      \n                                                                                                  \n batch_normalization_167 (B  (None, 29, 4, 192)           576       ['conv2d_167[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_167 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_167[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_164 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed7[0][0]']              \n                                                                                                  \n conv2d_168 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_167[0][0]']      \n                                                                                                  \n batch_normalization_164 (B  (None, 29, 4, 192)           576       ['conv2d_164[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_168 (B  (None, 29, 4, 192)           576       ['conv2d_168[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_164 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_164[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_168 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_168[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_165 (Conv2D)         (None, 14, 1, 320)           552960    ['activation_164[0][0]']      \n                                                                                                  \n conv2d_169 (Conv2D)         (None, 14, 1, 192)           331776    ['activation_168[0][0]']      \n                                                                                                  \n batch_normalization_165 (B  (None, 14, 1, 320)           960       ['conv2d_165[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_169 (B  (None, 14, 1, 192)           576       ['conv2d_169[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_165 (Activation  (None, 14, 1, 320)           0         ['batch_normalization_165[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_169 (Activation  (None, 14, 1, 192)           0         ['batch_normalization_169[0][0\n )                                                                  ]']                           \n                                                                                                  \n max_pooling2d_7 (MaxPoolin  (None, 14, 1, 768)           0         ['mixed7[0][0]']              \n g2D)                                                                                             \n                                                                                                  \n mixed8 (Concatenate)        (None, 14, 1, 1280)          0         ['activation_165[0][0]',      \n                                                                     'activation_169[0][0]',      \n                                                                     'max_pooling2d_7[0][0]']     \n                                                                                                  \n conv2d_174 (Conv2D)         (None, 14, 1, 448)           573440    ['mixed8[0][0]']              \n                                                                                                  \n batch_normalization_174 (B  (None, 14, 1, 448)           1344      ['conv2d_174[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_174 (Activation  (None, 14, 1, 448)           0         ['batch_normalization_174[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_171 (Conv2D)         (None, 14, 1, 384)           491520    ['mixed8[0][0]']              \n                                                                                                  \n conv2d_175 (Conv2D)         (None, 14, 1, 384)           1548288   ['activation_174[0][0]']      \n                                                                                                  \n batch_normalization_171 (B  (None, 14, 1, 384)           1152      ['conv2d_171[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_175 (B  (None, 14, 1, 384)           1152      ['conv2d_175[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_171 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_171[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_175 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_175[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_172 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_171[0][0]']      \n                                                                                                  \n conv2d_173 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_171[0][0]']      \n                                                                                                  \n conv2d_176 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_175[0][0]']      \n                                                                                                  \n conv2d_177 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_175[0][0]']      \n                                                                                                  \n average_pooling2d_16 (Aver  (None, 14, 1, 1280)          0         ['mixed8[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_170 (Conv2D)         (None, 14, 1, 320)           409600    ['mixed8[0][0]']              \n                                                                                                  \n batch_normalization_172 (B  (None, 14, 1, 384)           1152      ['conv2d_172[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_173 (B  (None, 14, 1, 384)           1152      ['conv2d_173[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_176 (B  (None, 14, 1, 384)           1152      ['conv2d_176[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_177 (B  (None, 14, 1, 384)           1152      ['conv2d_177[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n conv2d_178 (Conv2D)         (None, 14, 1, 192)           245760    ['average_pooling2d_16[0][0]']\n                                                                                                  \n batch_normalization_170 (B  (None, 14, 1, 320)           960       ['conv2d_170[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_172 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_172[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_173 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_173[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_176 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_176[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_177 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_177[0][0\n )                                                                  ]']                           \n                                                                                                  \n batch_normalization_178 (B  (None, 14, 1, 192)           576       ['conv2d_178[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_170 (Activation  (None, 14, 1, 320)           0         ['batch_normalization_170[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed9_0 (Concatenate)      (None, 14, 1, 768)           0         ['activation_172[0][0]',      \n                                                                     'activation_173[0][0]']      \n                                                                                                  \n concatenate_2 (Concatenate  (None, 14, 1, 768)           0         ['activation_176[0][0]',      \n )                                                                   'activation_177[0][0]']      \n                                                                                                  \n activation_178 (Activation  (None, 14, 1, 192)           0         ['batch_normalization_178[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed9 (Concatenate)        (None, 14, 1, 2048)          0         ['activation_170[0][0]',      \n                                                                     'mixed9_0[0][0]',            \n                                                                     'concatenate_2[0][0]',       \n                                                                     'activation_178[0][0]']      \n                                                                                                  \n conv2d_183 (Conv2D)         (None, 14, 1, 448)           917504    ['mixed9[0][0]']              \n                                                                                                  \n batch_normalization_183 (B  (None, 14, 1, 448)           1344      ['conv2d_183[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_183 (Activation  (None, 14, 1, 448)           0         ['batch_normalization_183[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_180 (Conv2D)         (None, 14, 1, 384)           786432    ['mixed9[0][0]']              \n                                                                                                  \n conv2d_184 (Conv2D)         (None, 14, 1, 384)           1548288   ['activation_183[0][0]']      \n                                                                                                  \n batch_normalization_180 (B  (None, 14, 1, 384)           1152      ['conv2d_180[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_184 (B  (None, 14, 1, 384)           1152      ['conv2d_184[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_180 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_180[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_184 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_184[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_181 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_180[0][0]']      \n                                                                                                  \n conv2d_182 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_180[0][0]']      \n                                                                                                  \n conv2d_185 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_184[0][0]']      \n                                                                                                  \n conv2d_186 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_184[0][0]']      \n                                                                                                  \n average_pooling2d_17 (Aver  (None, 14, 1, 2048)          0         ['mixed9[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_179 (Conv2D)         (None, 14, 1, 320)           655360    ['mixed9[0][0]']              \n                                                                                                  \n batch_normalization_181 (B  (None, 14, 1, 384)           1152      ['conv2d_181[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_182 (B  (None, 14, 1, 384)           1152      ['conv2d_182[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_185 (B  (None, 14, 1, 384)           1152      ['conv2d_185[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_186 (B  (None, 14, 1, 384)           1152      ['conv2d_186[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n conv2d_187 (Conv2D)         (None, 14, 1, 192)           393216    ['average_pooling2d_17[0][0]']\n                                                                                                  \n batch_normalization_179 (B  (None, 14, 1, 320)           960       ['conv2d_179[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_181 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_181[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_182 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_182[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_185 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_185[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_186 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_186[0][0\n )                                                                  ]']                           \n                                                                                                  \n batch_normalization_187 (B  (None, 14, 1, 192)           576       ['conv2d_187[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_179 (Activation  (None, 14, 1, 320)           0         ['batch_normalization_179[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed9_1 (Concatenate)      (None, 14, 1, 768)           0         ['activation_181[0][0]',      \n                                                                     'activation_182[0][0]']      \n                                                                                                  \n concatenate_3 (Concatenate  (None, 14, 1, 768)           0         ['activation_185[0][0]',      \n )                                                                   'activation_186[0][0]']      \n                                                                                                  \n activation_187 (Activation  (None, 14, 1, 192)           0         ['batch_normalization_187[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed10 (Concatenate)       (None, 14, 1, 2048)          0         ['activation_179[0][0]',      \n                                                                     'mixed9_1[0][0]',            \n                                                                     'concatenate_3[0][0]',       \n                                                                     'activation_187[0][0]']      \n                                                                                                  \n global_average_pooling2d_1  (None, 2048)                 0         ['mixed10[0][0]']             \n  (GlobalAveragePooling2D)                                                                        \n                                                                                                  \n dense_2 (Dense)             (None, 1024)                 2098176   ['global_average_pooling2d_1[0\n                                                                    ][0]']                        \n                                                                                                  \n dense_3 (Dense)             (None, 1)                    1025      ['dense_2[0][0]']             \n                                                                                                  \n==================================================================================================\nTotal params: 23901985 (91.18 MB)\nTrainable params: 2099201 (8.01 MB)\nNon-trainable params: 21802784 (83.17 MB)\n__________________________________________________________________________________________________\n```\n\nAdam is our optimizer and binary_crossentropy is the loss function\n\n``` python\nImported_model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\n\nImported_model.fit(train_x, train_y, epochs = 5, batch_size = 256, verbose=1, validation_data=(test_x, test_y))\n```\n\n## Save / Load the model\n\n``` python\nImported_model.save('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training/myModel.h5')\n#Imported_model.save_weights(\"myModel2.h5\", '/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training')\n```\n\n``` python\nfrom keras.models import load_model\nImported_model = load_model('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training/myModel.h5')\n#new_model.load_weights(\"myModel2.h5\")\n```\n\n# Test over two unseen image\n\n``` python\ntie_pred = cv2.imread('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Index_237.jpg')\ntie_pred = cv2.resize(tie_pred, (100, 500))\n\nbal_pred = cv2.imread('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Index_241.jpg')\nbal_pred = cv2.resize(bal_pred, (100, 500))\n```\n\n``` python\ncv2_imshow(tie_pred)\ncv2_imshow(bal_pred)\n```\n\n![](images/22.png)\n\n![](images/23.png)\n\n``` python\ntie_pred = tie_pred.astype('float32') / 255.0\nbal_pred = bal_pred.astype('float32') / 255.0\n```\n\n``` python\ntie_pred = np.array(tie_pred)\nbal_pred = np.array(bal_pred)\n\ntie_pred = np.expand_dims(tie_pred, axis=0)\nbal_pred = np.expand_dims(bal_pred, axis=0)\n```\n\n``` python\nprint(\"Probability of a ballast image to be tie : \",Imported_model.predict(bal_pred))\n```\n\n```         \n1/1 [==============================] - 0s 170ms/step Probability of a ballast image to be tie : [[0.02516897]]\n```\n\n``` python\nprint(\"Probability of a tie image to be tie : \",Imported_model.predict(tie_pred))\n```\n\n```         \n1/1 [==============================] - 0s 80ms/step Probability of a tie image to be tie : [[1.]]\n```\n\n# Do the prediction over the entire dataset\n\n``` python\nprediction = []\n\nfor i in range(0, len(df_new['processed_images'])):\n  prediction.append(np.array(cv2.resize(df_new.iloc[i]['processed_images'], (100, 500))))\n\nprediction = np.array(prediction)\n\nprediction = prediction.astype('float32') / 255.0\n\npred_label = Imported_model.predict(prediction)\n```\n\n```         \n84/84 [==============================] - 173s 2s/step\n```\n\nIf the predicted probability is\n\n-   \n\n    > 0.75 : Ties\n\n-   \\< 0.25 : Ballast\n\n-   in between : ambiguous\n\n``` python\nfinal_label = []\n\nfor i in range(0, len(pred_label)):\n  if pred_label[i]>=0.75:\n    final_label.append('T')\n  if pred_label[i]<=0.25:\n    final_label.append('B')\n  if (pred_label[i]>0.25) & (pred_label[i]<0.75):\n    final_label.append('A')\n\ndf_new['Predicted_labels'] = final_label\n```\n","srcMarkdownNoYaml":"\n\nThis study develops an effective system for in-motion and autonomous identification of crossties and ballast, toward implementing non-contact sensors that can evaluate the condition of railroad structures. An array of sensors that include distance LIDAR sensors, magnetic sensors, and cameras are employed to test a prototype system in motion, onboard a remotely controlled track cart that can travel at speeds of up to 10 mph. The tests are performed on revenue-service tracks and the measurements are used to develop autonomous post-processing approaches that can be readily adopted by the railroads. Two distinct techniques for the LIDAR sensors are explored. Next, a machine learning model is developed to achieve the task with potentially more accuracy. To this end, three machine learning models, using three types of inputs, are developed to identify the optimal model. The DecisionTree algorithm coupled with the standard deviation of the difference between two distance sensors proved to be the most effective.\n\n``` python\nfrom google.colab import drive\ndrive.mount('/content/drive')\n```\n\n```         \nMounted at /content/drive\n```\n\n``` python\n!pip install moviepy\n!pip3 install imageio==2.4.1\n!pip install --upgrade imageio-ffmpeg\n```\n\nImport the required libraries\n\n``` python\nimport cv2\nimport os\nimport numpy as np\nimport pandas as pd\nfrom google.colab.patches import cv2_imshow\nfrom numpy import genfromtxt\nfrom PIL import Image\nimport os\nimport moviepy.editor as mp\nfrom sklearn.utils import shuffle\nfrom sklearn.model_selection import train_test_split\n```\n\n# Reduce size\n\nDefine the video path and a path to save the reduced-size frames\n\n``` python\nvideo_path = '/content/drive/MyDrive/Track Buckling Project/230306 - Third Huckleberry Trail Test/GoPro/GX011334.MP4'\nsave_path = '/content/drive/MyDrive/Vision/Huckelberry/March_1'\n\ncap = cv2.VideoCapture(video_path)\n```\n\nHere is a frame of this video\n\n``` python\ncap.set(cv2.CAP_PROP_POS_MSEC,500000)\nhasFrames,image0 = cap.read()\n\nprint(\"The size of the frame : \", image0.shape)\ncv2_imshow(image0)\n```\n\n```         \nThe size of the frame :  (2988, 5312, 3)\n```\n\n![](images/20.png)\n\n``` python\nfps = cap.get(cv2.CAP_PROP_FPS)\nprint(\"Frame rate of the video is : \", fps)\n```\n\n```         \nFrame rate of the video is : 29.97002997002997\n```\n\n``` python\nclip_duration = cap.get(cv2.CAP_PROP_FRAME_COUNT) / cap.get(cv2.CAP_PROP_FPS)\nprint(\"Clip duration : {} (s)\".format(clip_duration))\n```\n\n```         \nClip duration : 766.6325333333333 (s)\n```\n\nSince processing 30 frames per second is too demanding, we need to resample the video to reduce computation time while still maintaining satisfactory spatial resolution. We opted for 10 fps\n\n``` python\nsp = 1 / 10\n```\n\nEach frame captures a wide range of views. To enhance precision, only a specific section of the image will be analyzed, while the rest will be ignored.\n\n``` python\ncv2_imshow(image0[:, int(image0.shape[1]/2-100):int(image0.shape[1]/2+100)])\n```\n\n![](images/21.png)\n\nIn this block all the frames will be shrinked by the factor of 1/10\n\n``` python\nclip = mp.VideoFileClip(video_path)\n\nmy_width = image0.shape[0]//10\nmy_height = image0.shape[1]//10\n\nclip_resized = clip.resize(newsize=(my_width,my_height))\nclip_resized.write_videofile(save_path + '/resized_video/1334_resized.MP4')\n```\n\n# Framing\n\n``` python\nvideo_path = save_path + '/resized_video/1334_resized.MP4' # reduced-size video path\n\ncap = cv2.VideoCapture(video_path)\ncap.set(cv2.CAP_PROP_POS_MSEC,500000)\nhasFrames,image0 = cap.read()\n\ncv2_imshow(image0[:, int(image0.shape[1]/2-10):int(image0.shape[1]/2+10)])\n```\n\n# Save the frames\n\nIn this block all the frames will be saved as seperate images for easier future use. The name of each frame will be: Index\\_\"frame number\".jpg\n\n``` python\ntime = 0\nimg = []\nt = []\n\nc = 0\npath = '/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Index_'\n\nwhile (time+500)<clip_duration:\n  cap.set(cv2.CAP_PROP_POS_MSEC,(time+500)*1000)\n  hasFrames,image = cap.read()\n  if hasFrames:\n    image = image[:, int(image.shape[1]/2-10):int(image.shape[1]/2+10)]\n    cv2.imwrite(path + str(c) + '.jpg', image)\n    img.append(image)\n    t.append(time)\n    c = c + 1\n  time += fps\n```\n\n``` python\nd = {'processed_images': img, 'time': t}\ndf = pd.DataFrame(data=d)\n\ndf.to_csv('/content/drive/MyDrive/Track Buckling Project/230306 - Third Huckleberry Trail Test/GoPro/1334_resized.csv')\n```\n\n# Load the data\n\n``` python\ndf_new = pd.read_csv('/content/drive/MyDrive/Track Buckling Project/230306 - Third Huckleberry Trail Test/GoPro/1334_resized.csv')\n```\n\n``` python\ndirpath = '/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/'\n```\n\nReload the images and their respective index\n\n``` python\nshots = []\nidx = []\n\nfor i in range(0, df_new['time'].shape[0]):\n  if os.path.exists(dirpath + 'Index_' + str(i) + '.jpg'):\n    shots.append(cv2.imread(dirpath + 'Index_' + str(i) + '.jpg'))\n    idx.append('Index_' + str(i))\n  else:\n    break\n\n\ndf_new['image_index'] = idx\ndf_new['processed_images'] = shots\n```\n\n# Training\n\n## Labeling\n\nBefore training the model, we need to manually label the images. For this purpose, a section of the dataset is chosen and labeled. The indices for all the ties in that specific section are saved in the following dataframe.\n\n``` python\ntie_index = pd.read_excel('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training/tie_index.xlsx')\n```\n\n``` python\nlabel = np.zeros(df_new['image_index'].shape[0])\n\nfor i in tie_index['tie_index']:\n  label[i] = 1\n\ndf_new['labels'] = label\ndf_train = df_new[(df_new['Unnamed: 0']>=47) & (df_new['Unnamed: 0']<=193)]\n```\n\nDefining the features\n\n``` python\nfeatures = []\n\nfor i in range(0, len(df_train['processed_images'])):\n  features.append(np.array(cv2.resize(df_train.iloc[i]['processed_images'], (100, 500))))\n\n\nfeatures = np.array(features)\n```\n\nDefining the labels\n\n``` python\nlabels = df_train['labels']\n```\n\nNormalizing the features\n\n``` python\nfeatures = features.astype('float32') / 255.0\n```\n\n## Train/Test Split\n\n``` python\ntrain_x, test_x, train_y, test_y = train_test_split(features, labels, test_size=0.2, stratify=labels)\n```\n\nAccording to the block below we have 117 data points in training set and 30 data points in test set\n\n``` python\nprint(train_x.shape)\nprint(train_y.shape)\nprint(test_x.shape)\nprint(test_y.shape)\n```\n\n```         \n(117, 500, 100, 3)\n(117,)\n(30, 500, 100, 3)\n(30,)\n```\n\n``` python\nfrom keras.applications.inception_v3 import InceptionV3\nfrom keras.preprocessing import image\nfrom keras.models import Model, Sequential\nfrom keras.layers import Dense, GlobalAveragePooling2D, Dropout, Flatten, Dense\n```\n\n## Importing Inception V3\n\n``` python\nbase_model = InceptionV3(weights='imagenet', include_top=False,input_shape=(train_x.shape[1],train_x.shape[2],train_x.shape[3]))\nfor layer in base_model.layers:\n    layer.trainable = False\n\nx = base_model.output\nx = GlobalAveragePooling2D()(x)\nx = Dense(1024, activation='relu')(x)\npredictions = Dense(1, activation='sigmoid')(x)\n\nImported_model = Model(inputs=base_model.input, outputs=predictions)\n```\n\n``` python\nImported_model.summary()\n```\n\n```         \nModel: \"model_1\"\n__________________________________________________________________________________________________\n Layer (type)                Output Shape                 Param #   Connected to                  \n==================================================================================================\n input_2 (InputLayer)        [(None, 500, 100, 3)]        0         []                            \n                                                                                                  \n conv2d_94 (Conv2D)          (None, 249, 49, 32)          864       ['input_2[0][0]']             \n                                                                                                  \n batch_normalization_94 (Ba  (None, 249, 49, 32)          96        ['conv2d_94[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_94 (Activation)  (None, 249, 49, 32)          0         ['batch_normalization_94[0][0]\n                                                                    ']                            \n                                                                                                  \n conv2d_95 (Conv2D)          (None, 247, 47, 32)          9216      ['activation_94[0][0]']       \n                                                                                                  \n batch_normalization_95 (Ba  (None, 247, 47, 32)          96        ['conv2d_95[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_95 (Activation)  (None, 247, 47, 32)          0         ['batch_normalization_95[0][0]\n                                                                    ']                            \n                                                                                                  \n conv2d_96 (Conv2D)          (None, 247, 47, 64)          18432     ['activation_95[0][0]']       \n                                                                                                  \n batch_normalization_96 (Ba  (None, 247, 47, 64)          192       ['conv2d_96[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_96 (Activation)  (None, 247, 47, 64)          0         ['batch_normalization_96[0][0]\n                                                                    ']                            \n                                                                                                  \n max_pooling2d_4 (MaxPoolin  (None, 123, 23, 64)          0         ['activation_96[0][0]']       \n g2D)                                                                                             \n                                                                                                  \n conv2d_97 (Conv2D)          (None, 123, 23, 80)          5120      ['max_pooling2d_4[0][0]']     \n                                                                                                  \n batch_normalization_97 (Ba  (None, 123, 23, 80)          240       ['conv2d_97[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_97 (Activation)  (None, 123, 23, 80)          0         ['batch_normalization_97[0][0]\n                                                                    ']                            \n                                                                                                  \n conv2d_98 (Conv2D)          (None, 121, 21, 192)         138240    ['activation_97[0][0]']       \n                                                                                                  \n batch_normalization_98 (Ba  (None, 121, 21, 192)         576       ['conv2d_98[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n activation_98 (Activation)  (None, 121, 21, 192)         0         ['batch_normalization_98[0][0]\n                                                                    ']                            \n                                                                                                  \n max_pooling2d_5 (MaxPoolin  (None, 60, 10, 192)          0         ['activation_98[0][0]']       \n g2D)                                                                                             \n                                                                                                  \n conv2d_102 (Conv2D)         (None, 60, 10, 64)           12288     ['max_pooling2d_5[0][0]']     \n                                                                                                  \n batch_normalization_102 (B  (None, 60, 10, 64)           192       ['conv2d_102[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_102 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_102[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_100 (Conv2D)         (None, 60, 10, 48)           9216      ['max_pooling2d_5[0][0]']     \n                                                                                                  \n conv2d_103 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_102[0][0]']      \n                                                                                                  \n batch_normalization_100 (B  (None, 60, 10, 48)           144       ['conv2d_100[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_103 (B  (None, 60, 10, 96)           288       ['conv2d_103[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_100 (Activation  (None, 60, 10, 48)           0         ['batch_normalization_100[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_103 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_103[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_9 (Avera  (None, 60, 10, 192)          0         ['max_pooling2d_5[0][0]']     \n gePooling2D)                                                                                     \n                                                                                                  \n conv2d_99 (Conv2D)          (None, 60, 10, 64)           12288     ['max_pooling2d_5[0][0]']     \n                                                                                                  \n conv2d_101 (Conv2D)         (None, 60, 10, 64)           76800     ['activation_100[0][0]']      \n                                                                                                  \n conv2d_104 (Conv2D)         (None, 60, 10, 96)           82944     ['activation_103[0][0]']      \n                                                                                                  \n conv2d_105 (Conv2D)         (None, 60, 10, 32)           6144      ['average_pooling2d_9[0][0]'] \n                                                                                                  \n batch_normalization_99 (Ba  (None, 60, 10, 64)           192       ['conv2d_99[0][0]']           \n tchNormalization)                                                                                \n                                                                                                  \n batch_normalization_101 (B  (None, 60, 10, 64)           192       ['conv2d_101[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_104 (B  (None, 60, 10, 96)           288       ['conv2d_104[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_105 (B  (None, 60, 10, 32)           96        ['conv2d_105[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_99 (Activation)  (None, 60, 10, 64)           0         ['batch_normalization_99[0][0]\n                                                                    ']                            \n                                                                                                  \n activation_101 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_101[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_104 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_104[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_105 (Activation  (None, 60, 10, 32)           0         ['batch_normalization_105[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed0 (Concatenate)        (None, 60, 10, 256)          0         ['activation_99[0][0]',       \n                                                                     'activation_101[0][0]',      \n                                                                     'activation_104[0][0]',      \n                                                                     'activation_105[0][0]']      \n                                                                                                  \n conv2d_109 (Conv2D)         (None, 60, 10, 64)           16384     ['mixed0[0][0]']              \n                                                                                                  \n batch_normalization_109 (B  (None, 60, 10, 64)           192       ['conv2d_109[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_109 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_109[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_107 (Conv2D)         (None, 60, 10, 48)           12288     ['mixed0[0][0]']              \n                                                                                                  \n conv2d_110 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_109[0][0]']      \n                                                                                                  \n batch_normalization_107 (B  (None, 60, 10, 48)           144       ['conv2d_107[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_110 (B  (None, 60, 10, 96)           288       ['conv2d_110[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_107 (Activation  (None, 60, 10, 48)           0         ['batch_normalization_107[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_110 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_110[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_10 (Aver  (None, 60, 10, 256)          0         ['mixed0[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_106 (Conv2D)         (None, 60, 10, 64)           16384     ['mixed0[0][0]']              \n                                                                                                  \n conv2d_108 (Conv2D)         (None, 60, 10, 64)           76800     ['activation_107[0][0]']      \n                                                                                                  \n conv2d_111 (Conv2D)         (None, 60, 10, 96)           82944     ['activation_110[0][0]']      \n                                                                                                  \n conv2d_112 (Conv2D)         (None, 60, 10, 64)           16384     ['average_pooling2d_10[0][0]']\n                                                                                                  \n batch_normalization_106 (B  (None, 60, 10, 64)           192       ['conv2d_106[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_108 (B  (None, 60, 10, 64)           192       ['conv2d_108[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_111 (B  (None, 60, 10, 96)           288       ['conv2d_111[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_112 (B  (None, 60, 10, 64)           192       ['conv2d_112[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_106 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_106[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_108 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_108[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_111 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_111[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_112 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_112[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed1 (Concatenate)        (None, 60, 10, 288)          0         ['activation_106[0][0]',      \n                                                                     'activation_108[0][0]',      \n                                                                     'activation_111[0][0]',      \n                                                                     'activation_112[0][0]']      \n                                                                                                  \n conv2d_116 (Conv2D)         (None, 60, 10, 64)           18432     ['mixed1[0][0]']              \n                                                                                                  \n batch_normalization_116 (B  (None, 60, 10, 64)           192       ['conv2d_116[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_116 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_116[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_114 (Conv2D)         (None, 60, 10, 48)           13824     ['mixed1[0][0]']              \n                                                                                                  \n conv2d_117 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_116[0][0]']      \n                                                                                                  \n batch_normalization_114 (B  (None, 60, 10, 48)           144       ['conv2d_114[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_117 (B  (None, 60, 10, 96)           288       ['conv2d_117[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_114 (Activation  (None, 60, 10, 48)           0         ['batch_normalization_114[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_117 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_117[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_11 (Aver  (None, 60, 10, 288)          0         ['mixed1[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_113 (Conv2D)         (None, 60, 10, 64)           18432     ['mixed1[0][0]']              \n                                                                                                  \n conv2d_115 (Conv2D)         (None, 60, 10, 64)           76800     ['activation_114[0][0]']      \n                                                                                                  \n conv2d_118 (Conv2D)         (None, 60, 10, 96)           82944     ['activation_117[0][0]']      \n                                                                                                  \n conv2d_119 (Conv2D)         (None, 60, 10, 64)           18432     ['average_pooling2d_11[0][0]']\n                                                                                                  \n batch_normalization_113 (B  (None, 60, 10, 64)           192       ['conv2d_113[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_115 (B  (None, 60, 10, 64)           192       ['conv2d_115[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_118 (B  (None, 60, 10, 96)           288       ['conv2d_118[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_119 (B  (None, 60, 10, 64)           192       ['conv2d_119[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_113 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_113[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_115 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_115[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_118 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_118[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_119 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_119[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed2 (Concatenate)        (None, 60, 10, 288)          0         ['activation_113[0][0]',      \n                                                                     'activation_115[0][0]',      \n                                                                     'activation_118[0][0]',      \n                                                                     'activation_119[0][0]']      \n                                                                                                  \n conv2d_121 (Conv2D)         (None, 60, 10, 64)           18432     ['mixed2[0][0]']              \n                                                                                                  \n batch_normalization_121 (B  (None, 60, 10, 64)           192       ['conv2d_121[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_121 (Activation  (None, 60, 10, 64)           0         ['batch_normalization_121[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_122 (Conv2D)         (None, 60, 10, 96)           55296     ['activation_121[0][0]']      \n                                                                                                  \n batch_normalization_122 (B  (None, 60, 10, 96)           288       ['conv2d_122[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_122 (Activation  (None, 60, 10, 96)           0         ['batch_normalization_122[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_120 (Conv2D)         (None, 29, 4, 384)           995328    ['mixed2[0][0]']              \n                                                                                                  \n conv2d_123 (Conv2D)         (None, 29, 4, 96)            82944     ['activation_122[0][0]']      \n                                                                                                  \n batch_normalization_120 (B  (None, 29, 4, 384)           1152      ['conv2d_120[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_123 (B  (None, 29, 4, 96)            288       ['conv2d_123[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_120 (Activation  (None, 29, 4, 384)           0         ['batch_normalization_120[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_123 (Activation  (None, 29, 4, 96)            0         ['batch_normalization_123[0][0\n )                                                                  ]']                           \n                                                                                                  \n max_pooling2d_6 (MaxPoolin  (None, 29, 4, 288)           0         ['mixed2[0][0]']              \n g2D)                                                                                             \n                                                                                                  \n mixed3 (Concatenate)        (None, 29, 4, 768)           0         ['activation_120[0][0]',      \n                                                                     'activation_123[0][0]',      \n                                                                     'max_pooling2d_6[0][0]']     \n                                                                                                  \n conv2d_128 (Conv2D)         (None, 29, 4, 128)           98304     ['mixed3[0][0]']              \n                                                                                                  \n batch_normalization_128 (B  (None, 29, 4, 128)           384       ['conv2d_128[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_128 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_128[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_129 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_128[0][0]']      \n                                                                                                  \n batch_normalization_129 (B  (None, 29, 4, 128)           384       ['conv2d_129[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_129 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_129[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_125 (Conv2D)         (None, 29, 4, 128)           98304     ['mixed3[0][0]']              \n                                                                                                  \n conv2d_130 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_129[0][0]']      \n                                                                                                  \n batch_normalization_125 (B  (None, 29, 4, 128)           384       ['conv2d_125[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_130 (B  (None, 29, 4, 128)           384       ['conv2d_130[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_125 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_125[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_130 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_130[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_126 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_125[0][0]']      \n                                                                                                  \n conv2d_131 (Conv2D)         (None, 29, 4, 128)           114688    ['activation_130[0][0]']      \n                                                                                                  \n batch_normalization_126 (B  (None, 29, 4, 128)           384       ['conv2d_126[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_131 (B  (None, 29, 4, 128)           384       ['conv2d_131[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_126 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_126[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_131 (Activation  (None, 29, 4, 128)           0         ['batch_normalization_131[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_12 (Aver  (None, 29, 4, 768)           0         ['mixed3[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_124 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed3[0][0]']              \n                                                                                                  \n conv2d_127 (Conv2D)         (None, 29, 4, 192)           172032    ['activation_126[0][0]']      \n                                                                                                  \n conv2d_132 (Conv2D)         (None, 29, 4, 192)           172032    ['activation_131[0][0]']      \n                                                                                                  \n conv2d_133 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_12[0][0]']\n                                                                                                  \n batch_normalization_124 (B  (None, 29, 4, 192)           576       ['conv2d_124[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_127 (B  (None, 29, 4, 192)           576       ['conv2d_127[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_132 (B  (None, 29, 4, 192)           576       ['conv2d_132[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_133 (B  (None, 29, 4, 192)           576       ['conv2d_133[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_124 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_124[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_127 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_127[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_132 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_132[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_133 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_133[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed4 (Concatenate)        (None, 29, 4, 768)           0         ['activation_124[0][0]',      \n                                                                     'activation_127[0][0]',      \n                                                                     'activation_132[0][0]',      \n                                                                     'activation_133[0][0]']      \n                                                                                                  \n conv2d_138 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed4[0][0]']              \n                                                                                                  \n batch_normalization_138 (B  (None, 29, 4, 160)           480       ['conv2d_138[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_138 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_138[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_139 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_138[0][0]']      \n                                                                                                  \n batch_normalization_139 (B  (None, 29, 4, 160)           480       ['conv2d_139[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_139 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_139[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_135 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed4[0][0]']              \n                                                                                                  \n conv2d_140 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_139[0][0]']      \n                                                                                                  \n batch_normalization_135 (B  (None, 29, 4, 160)           480       ['conv2d_135[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_140 (B  (None, 29, 4, 160)           480       ['conv2d_140[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_135 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_135[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_140 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_140[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_136 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_135[0][0]']      \n                                                                                                  \n conv2d_141 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_140[0][0]']      \n                                                                                                  \n batch_normalization_136 (B  (None, 29, 4, 160)           480       ['conv2d_136[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_141 (B  (None, 29, 4, 160)           480       ['conv2d_141[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_136 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_136[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_141 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_141[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_13 (Aver  (None, 29, 4, 768)           0         ['mixed4[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_134 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed4[0][0]']              \n                                                                                                  \n conv2d_137 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_136[0][0]']      \n                                                                                                  \n conv2d_142 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_141[0][0]']      \n                                                                                                  \n conv2d_143 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_13[0][0]']\n                                                                                                  \n batch_normalization_134 (B  (None, 29, 4, 192)           576       ['conv2d_134[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_137 (B  (None, 29, 4, 192)           576       ['conv2d_137[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_142 (B  (None, 29, 4, 192)           576       ['conv2d_142[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_143 (B  (None, 29, 4, 192)           576       ['conv2d_143[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_134 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_134[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_137 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_137[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_142 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_142[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_143 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_143[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed5 (Concatenate)        (None, 29, 4, 768)           0         ['activation_134[0][0]',      \n                                                                     'activation_137[0][0]',      \n                                                                     'activation_142[0][0]',      \n                                                                     'activation_143[0][0]']      \n                                                                                                  \n conv2d_148 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed5[0][0]']              \n                                                                                                  \n batch_normalization_148 (B  (None, 29, 4, 160)           480       ['conv2d_148[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_148 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_148[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_149 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_148[0][0]']      \n                                                                                                  \n batch_normalization_149 (B  (None, 29, 4, 160)           480       ['conv2d_149[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_149 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_149[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_145 (Conv2D)         (None, 29, 4, 160)           122880    ['mixed5[0][0]']              \n                                                                                                  \n conv2d_150 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_149[0][0]']      \n                                                                                                  \n batch_normalization_145 (B  (None, 29, 4, 160)           480       ['conv2d_145[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_150 (B  (None, 29, 4, 160)           480       ['conv2d_150[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_145 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_145[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_150 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_150[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_146 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_145[0][0]']      \n                                                                                                  \n conv2d_151 (Conv2D)         (None, 29, 4, 160)           179200    ['activation_150[0][0]']      \n                                                                                                  \n batch_normalization_146 (B  (None, 29, 4, 160)           480       ['conv2d_146[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_151 (B  (None, 29, 4, 160)           480       ['conv2d_151[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_146 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_146[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_151 (Activation  (None, 29, 4, 160)           0         ['batch_normalization_151[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_14 (Aver  (None, 29, 4, 768)           0         ['mixed5[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_144 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed5[0][0]']              \n                                                                                                  \n conv2d_147 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_146[0][0]']      \n                                                                                                  \n conv2d_152 (Conv2D)         (None, 29, 4, 192)           215040    ['activation_151[0][0]']      \n                                                                                                  \n conv2d_153 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_14[0][0]']\n                                                                                                  \n batch_normalization_144 (B  (None, 29, 4, 192)           576       ['conv2d_144[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_147 (B  (None, 29, 4, 192)           576       ['conv2d_147[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_152 (B  (None, 29, 4, 192)           576       ['conv2d_152[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_153 (B  (None, 29, 4, 192)           576       ['conv2d_153[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_144 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_144[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_147 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_147[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_152 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_152[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_153 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_153[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed6 (Concatenate)        (None, 29, 4, 768)           0         ['activation_144[0][0]',      \n                                                                     'activation_147[0][0]',      \n                                                                     'activation_152[0][0]',      \n                                                                     'activation_153[0][0]']      \n                                                                                                  \n conv2d_158 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed6[0][0]']              \n                                                                                                  \n batch_normalization_158 (B  (None, 29, 4, 192)           576       ['conv2d_158[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_158 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_158[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_159 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_158[0][0]']      \n                                                                                                  \n batch_normalization_159 (B  (None, 29, 4, 192)           576       ['conv2d_159[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_159 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_159[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_155 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed6[0][0]']              \n                                                                                                  \n conv2d_160 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_159[0][0]']      \n                                                                                                  \n batch_normalization_155 (B  (None, 29, 4, 192)           576       ['conv2d_155[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_160 (B  (None, 29, 4, 192)           576       ['conv2d_160[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_155 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_155[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_160 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_160[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_156 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_155[0][0]']      \n                                                                                                  \n conv2d_161 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_160[0][0]']      \n                                                                                                  \n batch_normalization_156 (B  (None, 29, 4, 192)           576       ['conv2d_156[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_161 (B  (None, 29, 4, 192)           576       ['conv2d_161[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_156 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_156[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_161 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_161[0][0\n )                                                                  ]']                           \n                                                                                                  \n average_pooling2d_15 (Aver  (None, 29, 4, 768)           0         ['mixed6[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_154 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed6[0][0]']              \n                                                                                                  \n conv2d_157 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_156[0][0]']      \n                                                                                                  \n conv2d_162 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_161[0][0]']      \n                                                                                                  \n conv2d_163 (Conv2D)         (None, 29, 4, 192)           147456    ['average_pooling2d_15[0][0]']\n                                                                                                  \n batch_normalization_154 (B  (None, 29, 4, 192)           576       ['conv2d_154[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_157 (B  (None, 29, 4, 192)           576       ['conv2d_157[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_162 (B  (None, 29, 4, 192)           576       ['conv2d_162[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_163 (B  (None, 29, 4, 192)           576       ['conv2d_163[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_154 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_154[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_157 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_157[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_162 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_162[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_163 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_163[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed7 (Concatenate)        (None, 29, 4, 768)           0         ['activation_154[0][0]',      \n                                                                     'activation_157[0][0]',      \n                                                                     'activation_162[0][0]',      \n                                                                     'activation_163[0][0]']      \n                                                                                                  \n conv2d_166 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed7[0][0]']              \n                                                                                                  \n batch_normalization_166 (B  (None, 29, 4, 192)           576       ['conv2d_166[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_166 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_166[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_167 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_166[0][0]']      \n                                                                                                  \n batch_normalization_167 (B  (None, 29, 4, 192)           576       ['conv2d_167[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_167 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_167[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_164 (Conv2D)         (None, 29, 4, 192)           147456    ['mixed7[0][0]']              \n                                                                                                  \n conv2d_168 (Conv2D)         (None, 29, 4, 192)           258048    ['activation_167[0][0]']      \n                                                                                                  \n batch_normalization_164 (B  (None, 29, 4, 192)           576       ['conv2d_164[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_168 (B  (None, 29, 4, 192)           576       ['conv2d_168[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_164 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_164[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_168 (Activation  (None, 29, 4, 192)           0         ['batch_normalization_168[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_165 (Conv2D)         (None, 14, 1, 320)           552960    ['activation_164[0][0]']      \n                                                                                                  \n conv2d_169 (Conv2D)         (None, 14, 1, 192)           331776    ['activation_168[0][0]']      \n                                                                                                  \n batch_normalization_165 (B  (None, 14, 1, 320)           960       ['conv2d_165[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_169 (B  (None, 14, 1, 192)           576       ['conv2d_169[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_165 (Activation  (None, 14, 1, 320)           0         ['batch_normalization_165[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_169 (Activation  (None, 14, 1, 192)           0         ['batch_normalization_169[0][0\n )                                                                  ]']                           \n                                                                                                  \n max_pooling2d_7 (MaxPoolin  (None, 14, 1, 768)           0         ['mixed7[0][0]']              \n g2D)                                                                                             \n                                                                                                  \n mixed8 (Concatenate)        (None, 14, 1, 1280)          0         ['activation_165[0][0]',      \n                                                                     'activation_169[0][0]',      \n                                                                     'max_pooling2d_7[0][0]']     \n                                                                                                  \n conv2d_174 (Conv2D)         (None, 14, 1, 448)           573440    ['mixed8[0][0]']              \n                                                                                                  \n batch_normalization_174 (B  (None, 14, 1, 448)           1344      ['conv2d_174[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_174 (Activation  (None, 14, 1, 448)           0         ['batch_normalization_174[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_171 (Conv2D)         (None, 14, 1, 384)           491520    ['mixed8[0][0]']              \n                                                                                                  \n conv2d_175 (Conv2D)         (None, 14, 1, 384)           1548288   ['activation_174[0][0]']      \n                                                                                                  \n batch_normalization_171 (B  (None, 14, 1, 384)           1152      ['conv2d_171[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_175 (B  (None, 14, 1, 384)           1152      ['conv2d_175[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_171 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_171[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_175 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_175[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_172 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_171[0][0]']      \n                                                                                                  \n conv2d_173 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_171[0][0]']      \n                                                                                                  \n conv2d_176 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_175[0][0]']      \n                                                                                                  \n conv2d_177 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_175[0][0]']      \n                                                                                                  \n average_pooling2d_16 (Aver  (None, 14, 1, 1280)          0         ['mixed8[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_170 (Conv2D)         (None, 14, 1, 320)           409600    ['mixed8[0][0]']              \n                                                                                                  \n batch_normalization_172 (B  (None, 14, 1, 384)           1152      ['conv2d_172[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_173 (B  (None, 14, 1, 384)           1152      ['conv2d_173[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_176 (B  (None, 14, 1, 384)           1152      ['conv2d_176[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_177 (B  (None, 14, 1, 384)           1152      ['conv2d_177[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n conv2d_178 (Conv2D)         (None, 14, 1, 192)           245760    ['average_pooling2d_16[0][0]']\n                                                                                                  \n batch_normalization_170 (B  (None, 14, 1, 320)           960       ['conv2d_170[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_172 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_172[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_173 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_173[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_176 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_176[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_177 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_177[0][0\n )                                                                  ]']                           \n                                                                                                  \n batch_normalization_178 (B  (None, 14, 1, 192)           576       ['conv2d_178[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_170 (Activation  (None, 14, 1, 320)           0         ['batch_normalization_170[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed9_0 (Concatenate)      (None, 14, 1, 768)           0         ['activation_172[0][0]',      \n                                                                     'activation_173[0][0]']      \n                                                                                                  \n concatenate_2 (Concatenate  (None, 14, 1, 768)           0         ['activation_176[0][0]',      \n )                                                                   'activation_177[0][0]']      \n                                                                                                  \n activation_178 (Activation  (None, 14, 1, 192)           0         ['batch_normalization_178[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed9 (Concatenate)        (None, 14, 1, 2048)          0         ['activation_170[0][0]',      \n                                                                     'mixed9_0[0][0]',            \n                                                                     'concatenate_2[0][0]',       \n                                                                     'activation_178[0][0]']      \n                                                                                                  \n conv2d_183 (Conv2D)         (None, 14, 1, 448)           917504    ['mixed9[0][0]']              \n                                                                                                  \n batch_normalization_183 (B  (None, 14, 1, 448)           1344      ['conv2d_183[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_183 (Activation  (None, 14, 1, 448)           0         ['batch_normalization_183[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_180 (Conv2D)         (None, 14, 1, 384)           786432    ['mixed9[0][0]']              \n                                                                                                  \n conv2d_184 (Conv2D)         (None, 14, 1, 384)           1548288   ['activation_183[0][0]']      \n                                                                                                  \n batch_normalization_180 (B  (None, 14, 1, 384)           1152      ['conv2d_180[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_184 (B  (None, 14, 1, 384)           1152      ['conv2d_184[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_180 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_180[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_184 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_184[0][0\n )                                                                  ]']                           \n                                                                                                  \n conv2d_181 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_180[0][0]']      \n                                                                                                  \n conv2d_182 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_180[0][0]']      \n                                                                                                  \n conv2d_185 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_184[0][0]']      \n                                                                                                  \n conv2d_186 (Conv2D)         (None, 14, 1, 384)           442368    ['activation_184[0][0]']      \n                                                                                                  \n average_pooling2d_17 (Aver  (None, 14, 1, 2048)          0         ['mixed9[0][0]']              \n agePooling2D)                                                                                    \n                                                                                                  \n conv2d_179 (Conv2D)         (None, 14, 1, 320)           655360    ['mixed9[0][0]']              \n                                                                                                  \n batch_normalization_181 (B  (None, 14, 1, 384)           1152      ['conv2d_181[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_182 (B  (None, 14, 1, 384)           1152      ['conv2d_182[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_185 (B  (None, 14, 1, 384)           1152      ['conv2d_185[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n batch_normalization_186 (B  (None, 14, 1, 384)           1152      ['conv2d_186[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n conv2d_187 (Conv2D)         (None, 14, 1, 192)           393216    ['average_pooling2d_17[0][0]']\n                                                                                                  \n batch_normalization_179 (B  (None, 14, 1, 320)           960       ['conv2d_179[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_181 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_181[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_182 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_182[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_185 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_185[0][0\n )                                                                  ]']                           \n                                                                                                  \n activation_186 (Activation  (None, 14, 1, 384)           0         ['batch_normalization_186[0][0\n )                                                                  ]']                           \n                                                                                                  \n batch_normalization_187 (B  (None, 14, 1, 192)           576       ['conv2d_187[0][0]']          \n atchNormalization)                                                                               \n                                                                                                  \n activation_179 (Activation  (None, 14, 1, 320)           0         ['batch_normalization_179[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed9_1 (Concatenate)      (None, 14, 1, 768)           0         ['activation_181[0][0]',      \n                                                                     'activation_182[0][0]']      \n                                                                                                  \n concatenate_3 (Concatenate  (None, 14, 1, 768)           0         ['activation_185[0][0]',      \n )                                                                   'activation_186[0][0]']      \n                                                                                                  \n activation_187 (Activation  (None, 14, 1, 192)           0         ['batch_normalization_187[0][0\n )                                                                  ]']                           \n                                                                                                  \n mixed10 (Concatenate)       (None, 14, 1, 2048)          0         ['activation_179[0][0]',      \n                                                                     'mixed9_1[0][0]',            \n                                                                     'concatenate_3[0][0]',       \n                                                                     'activation_187[0][0]']      \n                                                                                                  \n global_average_pooling2d_1  (None, 2048)                 0         ['mixed10[0][0]']             \n  (GlobalAveragePooling2D)                                                                        \n                                                                                                  \n dense_2 (Dense)             (None, 1024)                 2098176   ['global_average_pooling2d_1[0\n                                                                    ][0]']                        \n                                                                                                  \n dense_3 (Dense)             (None, 1)                    1025      ['dense_2[0][0]']             \n                                                                                                  \n==================================================================================================\nTotal params: 23901985 (91.18 MB)\nTrainable params: 2099201 (8.01 MB)\nNon-trainable params: 21802784 (83.17 MB)\n__________________________________________________________________________________________________\n```\n\nAdam is our optimizer and binary_crossentropy is the loss function\n\n``` python\nImported_model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\n\nImported_model.fit(train_x, train_y, epochs = 5, batch_size = 256, verbose=1, validation_data=(test_x, test_y))\n```\n\n## Save / Load the model\n\n``` python\nImported_model.save('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training/myModel.h5')\n#Imported_model.save_weights(\"myModel2.h5\", '/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training')\n```\n\n``` python\nfrom keras.models import load_model\nImported_model = load_model('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Training/myModel.h5')\n#new_model.load_weights(\"myModel2.h5\")\n```\n\n# Test over two unseen image\n\n``` python\ntie_pred = cv2.imread('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Index_237.jpg')\ntie_pred = cv2.resize(tie_pred, (100, 500))\n\nbal_pred = cv2.imread('/content/drive/MyDrive/Vision/Huckelberry/March_6/1334/10fps/Index_241.jpg')\nbal_pred = cv2.resize(bal_pred, (100, 500))\n```\n\n``` python\ncv2_imshow(tie_pred)\ncv2_imshow(bal_pred)\n```\n\n![](images/22.png)\n\n![](images/23.png)\n\n``` python\ntie_pred = tie_pred.astype('float32') / 255.0\nbal_pred = bal_pred.astype('float32') / 255.0\n```\n\n``` python\ntie_pred = np.array(tie_pred)\nbal_pred = np.array(bal_pred)\n\ntie_pred = np.expand_dims(tie_pred, axis=0)\nbal_pred = np.expand_dims(bal_pred, axis=0)\n```\n\n``` python\nprint(\"Probability of a ballast image to be tie : \",Imported_model.predict(bal_pred))\n```\n\n```         \n1/1 [==============================] - 0s 170ms/step Probability of a ballast image to be tie : [[0.02516897]]\n```\n\n``` python\nprint(\"Probability of a tie image to be tie : \",Imported_model.predict(tie_pred))\n```\n\n```         \n1/1 [==============================] - 0s 80ms/step Probability of a tie image to be tie : [[1.]]\n```\n\n# Do the prediction over the entire dataset\n\n``` python\nprediction = []\n\nfor i in range(0, len(df_new['processed_images'])):\n  prediction.append(np.array(cv2.resize(df_new.iloc[i]['processed_images'], (100, 500))))\n\nprediction = np.array(prediction)\n\nprediction = prediction.astype('float32') / 255.0\n\npred_label = Imported_model.predict(prediction)\n```\n\n```         \n84/84 [==============================] - 173s 2s/step\n```\n\nIf the predicted probability is\n\n-   \n\n    > 0.75 : Ties\n\n-   \\< 0.25 : Ballast\n\n-   in between : ambiguous\n\n``` python\nfinal_label = []\n\nfor i in range(0, len(pred_label)):\n  if pred_label[i]>=0.75:\n    final_label.append('T')\n  if pred_label[i]<=0.25:\n    final_label.append('B')\n  if (pred_label[i]>0.25) & (pred_label[i]<0.75):\n    final_label.append('A')\n\ndf_new['Predicted_labels'] = final_label\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"CV for Tie-Ballast","author":"Morteza Mirzaei","date":"2023-12-09","categories":["code","analysis"],"image":"image.jpg"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}